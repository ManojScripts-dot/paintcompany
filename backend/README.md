# Paint Website API

A FastAPI backend for a paint company website with SQLite database and legacy API endpoints.

## Features

- **SQLite Database**: Lightweight, file-based database
- **Legacy API**: No versioning, simple endpoint structure
- **Authentication**: JWT-based authentication for admin users
- **File Upload**: Image upload support for products
- **CORS Support**: Configured for frontend integration
- **Render Deployment**: Ready for deployment on Render

## API Endpoints

### Authentication
- `POST /auth/login` - Admin login
- `POST /auth/refresh` - Refresh access token
- `GET /auth/me` - Get current user info
- `POST /auth/logout` - Logout (revoke tokens)

### Public API
- `GET /api/popular-products` - Get popular products
- `GET /api/new-arrivals` - Get new arrivals
- `GET /api/news-events` - Get news and events
- `GET /api/contact` - Get contact info
- `POST /api/contact` - Submit contact form
- `GET /api/products` - Get products

### Admin API
- `GET /admin/popular-products` - Admin popular products management
- `GET /admin/new-arrivals` - Admin new arrivals management
- `GET /admin/news-events` - Admin news/events management
- `GET /admin/contact` - Admin contact submissions
- `GET /admin/products` - Admin products management
- `GET /admin/password` - Admin password management

## Local Development

### Prerequisites
- Python 3.8+
- pip

### Setup

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd paintcompanybackend
   ```

2. **Create virtual environment**
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

4. **Initialize database**
   ```bash
   python init_db.py
   ```

5. **Start the development server**
   ```bash
   uvicorn app.main:app --reload
   ```

The API will be available at `http://localhost:8000`

### Default Admin Credentials
- Username: `admin`
- Password: `admin123`

## Database

The application uses SQLite as the database. The database file is created at `paint_website.db` by default.

### Database Schema
- `admin_users` - Admin user accounts
- `popular_products` - Popular products catalog
- `new_arrivals` - New product arrivals
- `news_events` - News and events
- `contact_submissions` - Contact form submissions
- `static_contact_info` - Static contact information
- `products` - Product catalog
- `revoked_tokens` - Revoked JWT tokens

## Environment Variables

Create a `.env` file in the root directory:

```env
ENV=development
SECRET_KEY=your-super-secret-key-for-jwt
SUPERADMIN_RESET_KEY=bardali creations create this website
SQLITE_DB_PATH=paint_website.db
LOG_LEVEL=INFO
```

## Deployment on Render

### Automatic Deployment

1. **Connect your GitHub repository to Render**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New +" and select "Web Service"
   - Connect your GitHub repository

2. **Configure the service**
   - **Name**: `paint-website-api`
   - **Environment**: `Python`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `chmod +x start.sh && ./start.sh`

3. **Environment Variables**
   - `ENV`: `production`
   - `SECRET_KEY`: (auto-generated by Render)
   - `SUPERADMIN_RESET_KEY`: `bardali creations create this website`
   - `SQLITE_DB_PATH`: `/opt/render/project/src/paint_website.db`

### Manual Deployment

1. **Push your code to GitHub**

2. **Create a new Web Service on Render**
   - Use the `render.yaml` configuration file
   - Render will automatically detect and use the configuration

3. **The service will automatically:**
   - Install dependencies
   - Initialize the SQLite database
   - Start the application

## File Structure

```
paintcompanybackend/
├── app/
│   ├── api/
│   │   ├── admin/          # Admin API endpoints
│   │   └── public/         # Public API endpoints
│   ├── auth/               # Authentication
│   ├── models/             # Database models and schemas
│   ├── utils/              # Utility functions
│   ├── config.py           # Configuration
│   ├── database.py         # Database connection
│   └── main.py            # FastAPI application
├── migrations/
│   └── sqlite_init.sql    # SQLite database schema
├── static/                 # Static files and uploads
├── init_db.py             # Database initialization script
├── start.sh               # Startup script for Render
├── render.yaml            # Render deployment configuration
├── requirements.txt       # Python dependencies
└── README.md             # This file
```

## API Documentation

Once the server is running, you can access:
- **Interactive API docs**: `http://localhost:8000/docs`
- **ReDoc documentation**: `http://localhost:8000/redoc`

## Health Checks

- `GET /health` - Basic health check
- `GET /health/db` - Database health check

## Notes

- The application uses SQLite for simplicity and ease of deployment
- All API endpoints use legacy (non-versioned) URLs
- File uploads are stored in the `static/uploads/` directory
- CORS is configured for local development and common frontend ports
- The database is automatically initialized on first run 